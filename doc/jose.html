<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--<meta http-equiv="Content-Security-Policy" content="default-src 'none'">-->
    <title>jCastle documentation</title>
    <link rel="stylesheet" href="../static/lib/bootstrap-4.6.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/lib/AdminLTE-3.2.0/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="../static/lib/fontawesome-6.1.1/css/all.min.css">
    <link rel="stylesheet" href="./style.css" type="text/css">
    

    <script type="text/javascript" src="../static/lib/jquery-3.6.0.min.js"></script>
    <!--<script>
    window.jQuery = window.$ = require('jquery');
    </script>-->
    <script type="text/javascript" src="../static/lib/bootstrap-4.6.1/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="../static/lib/AdminLTe-3.2.0/dist/js/adminlte.min.js"></script>
    <script type="text/javascript" src="../static/lib/fontawesome-6.1.1/js/all.min.js"></script>
    <script type="text/javascript" src="./api.js"></script>

    <style>
        body {
            overflow-x: hidden;
        }
        #column2::-webkit-scrollbar {
            display: none;
        }
        .blink_me {
          animation: blinker 5s linear infinite;
        }

        @keyframes blinker {
          50% {
            opacity: 0;
          }
        }
        .cursor-pointer {
            cursor:  pointer;
        }
        .mark {
          background-color:  transparent;
        }
    </style>
</head>
<body class="apidoc" id="api-section-index">

    <div id="content" class="clearfix">
      <div id="column2" class="interior">
        <div id="intro" class="interior">
          <a href="/" title="Go back to the home page">
            <span style="font-size: 2rem">jCastle</span> <span style="color: #AED6F1; font-size: 14px">(v2.0)</span>
          </a>
        </div>

        <ul>
<li><a href="mcrypt.html">mcrypt - Message Crypt</a></li>
<li><a href="algorithms.html">Message Crypt Algorithms</a></li>
<li><a href="mcrypt-mode.html">Mcrypt Modes</a></li>
<li><a href="digest.html">digest - Message Digest</a></li>
<li><a href="hashes.html">Hash Algorithms</a></li>
<li><a href="mac.html">mac - Message Authentication Code</a></li>
<li><a href="mac-mode.html">MAC Modes</a></li>
<li><a href="hmac.html">hmac - Hash MAC</a></li>
<li><a href="kdf.html">kdf - Key Derive Function</a></li>
<li><a href="pki.html">pki - Public Key Infrastructure</a></li>
<li><a href="pki-rsa.html">pki.rsa - RSA</a></li>
<li><a href="pki-dsa.html">pki.dsa - DSA</a></li>
<li><a href="pki-ecdsa.html">pki.ecdsa - ECDSA</a></li>
<li><a href="pki-kcdsa.html">pki.kcdsa - KCDSA</a></li>
<li><a href="pki-eckcdsa.html">pki.eckcdsa - EC-KCDSA</a></li>
<li><a href="pki-elgamal.html">pki.elgamal - ElGamal</a></li>
<li><a href="dh.html">dh - Diffie–Hellman Key Exchange</a></li>
<li><a href="ecdh.html">ecdh - DH with Elliptic Curve Cryptographic System</a></li>
<li><a href="asn1.html">asn1 - Abstract Syntax Notation #1</a></li>
<li><a href="certConfig.html">certConfig - openssl.cnf reader or parser</a></li>
<li><a href="certificate.html">certificate - X.509 Certificate</a></li>
<li><a href="cms.html">cms - Cryptographic Message Syntax</a></li>
<li><a href="pfx.html">pfx - Personal Information Exchange</a></li>
<li><a href="keywrap.html">keywrap - Key Wrapping Algorithm</a></li>
<li><a href="jose.html">jose - Javascript Object Signing & Encryption</a></li>
<li><a href="prng.html">prng - Pseudorandom number generator</a></li>
        </ul>
      </div>

      <div id="column1" data-id="index" class="interior">
        <header class="header">
          <div class="header-container">
            <h1>jCastle v2.0 documentation</h1>
            <button class="theme-toggle-btn" id="theme-toggle-btn" title="Toggle dark mode/light mode" aria-label="Toggle dark mode/light mode" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" height="24" width="24">
              <path fill="none" d="M0 0h24v24H0z" />
              <path d="M11.1 12.08c-2.33-4.51-.5-8.48.53-10.07C6.27 2.2 1.98 6.59 1.98 12c0 .14.02.28.02.42.62-.27 1.29-.42 2-.42 1.66 0 3.18.83 4.1 2.15A4.01 4.01 0 0111 18c0 1.52-.87 2.83-2.12 3.51.98.32 2.03.5 3.11.5 3.5 0 6.58-1.8 8.37-4.52-2.36.23-6.98-.97-9.26-5.41z"/>
              <path d="M7 16h-.18C6.4 14.84 5.3 14 4 14c-1.66 0-3 1.34-3 3s1.34 3 3 3h3c1.1 0 2-.9 2-2s-.9-2-2-2z"/>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" height="24" width="24">
              <path d="M0 0h24v24H0z" fill="none" />
              <path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/>
            </svg>
            </button>
          </div>
          
          <hr>
        </header>

        <!-- TOC -->

        <div id="apicontent">


<ul class="d-none">
<li><a href="mcrypt.html">mcrypt - Message Crypt</a></li>
<li><a href="algorithms.html">Message Crypt Algorithms</a></li>
<li><a href="mcrypt-mode.html">Mcrypt Modes</a></li>
<li><a href="digest.html">digest - Message Digest</a></li>
<li><a href="hashes.html">Hash Algorithms</a></li>
<li><a href="mac.html">mac - Message Authentication Code</a></li>
<li><a href="mac-mode.html">MAC Modes</a></li>
<li><a href="hmac.html">hmac - Hash MAC</a></li>
<li><a href="kdf.html">kdf - Key Derive Function</a></li>
<li><a href="pki.html">pki - Public Key Infrastructure</a></li>
<li><a href="pki-rsa.html">pki.rsa - RSA</a></li>
<li><a href="pki-dsa.html">pki.dsa - DSA</a></li>
<li><a href="pki-ecdsa.html">pki.ecdsa - ECDSA</a></li>
<li><a href="pki-kcdsa.html">pki.kcdsa - KCDSA</a></li>
<li><a href="pki-eckcdsa.html">pki.eckcdsa - EC-KCDSA</a></li>
<li><a href="pki-elgamal.html">pki.elgamal - ElGamal</a></li>
<li><a href="dh.html">dh - Diffie–Hellman Key Exchange</a></li>
<li><a href="ecdh.html">ecdh - DH with Elliptic Curve Cryptographic System</a></li>
<li><a href="asn1.html">asn1 - Abstract Syntax Notation #1</a></li>
<li><a href="certConfig.html">certConfig - openssl.cnf reader or parser</a></li>
<li><a href="certificate.html">certificate - X.509 Certificate</a></li>
<li><a href="cms.html">cms - Cryptographic Message Syntax</a></li>
<li><a href="pfx.html">pfx - Personal Information Exchange</a></li>
<li><a href="keywrap.html">keywrap - Key Wrapping Algorithm</a></li>
<li><a href="jose.html">jose - Javascript Object Signing & Encryption</a></li>
<li><a href="prng.html">prng - Pseudorandom number generator</a></li>
</ul>


<section>

  <h3>Class:<code>jCastle.jose</code><span><a class="mark" href="#class-jose" id="class-jose">#</a></span><a aria-hidden="true" class="legacy" id="class_jose"></a></h3>

  <p><code>JOSE</code>는 Javascript Object Signing & Encryption의 약자로 JSON을 이용한 암호화 및 서명 함수 모듈을 말합니다.</p>
  <p><code>JOSE</code>로 웹 서명을 하는 경우 <code>JWS</code>(JSON Web Signature)라 칭하며, JOSE로 웹 암호화를 하는 경우 <code>JWE</code>(JSON Web Encryption)이라 부릅니다.</p>
  <p><code>JOSE</code>로 생성된 <code>BASE64URL</code> 문자와 콤마(.)의 조합으로 된 문자열을 <code>JWT</code>(JSON Web Token)이라 하며 키 정보를 담고 있는 객체는 <code>JWK</code>(JSON Web Key)라 합니다.</p>
  <p><code>jCastle.jose</code>는 <code>JWS</code>에 해당하는 sign/verity 및 parse/validate 메소드를 지원하며 <code>JWE</code>에 해당하는 encrypt/decrypt 메소드를 지원합니다.
  </p>

  <!-- new jCastle.jose() -->
  <h4><code>new jCastle.jose()</code><span><a class="mark" href="#new-jose-intance" id="new-jose-instance">#</a></span><a aria-hidden="true" class="legacy" id="new_jose_instance"></a></h4>

  <p><code>jCastle.jose</code> 오브젝트를 생성합니다.</p>


  <!-- jCastle.jose.create() -->
  <h4>Static method: <code>jCastle.jose.create()</code><span><a class="mark" href="#static-jose-create" id="static-jose-create">#</a></span><a aria-hidden="true" class="legacy" id="static_jose_create"></a></h4>

  <p><code>jCastle.jose</code> 오브젝트를 생성합니다. <code>new jCastle.jose()</code>와 동일합니다.</p>

  <ul>
    <li>Return Value: <code>jCastle.jose</code> 오브젝트를 생성하여 리턴합니다.</li>
  </ul>

  <!-- jCastle.jose.jws.sign(payload, algo_params, options) -->
  <h4>Static method: <code>jCastle.jose.jws.sign(payload, algo_params, options)</code> <span><a class="mark" href="#static-jose-jws-sign" id="static-jose-jws-sign">#</a></span><a aria-hidden="true" class="legacy" id="static_jose_jws_sign"></a></h4>

  <p> 주어진 데이터를 가지고 <code>JWS</code> 서명을 생성합니다.</p>

  <ul>
    <li><code>payload</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 서명할 입력 데이터. 만일 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a>으로 주어지면 자동으로 <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a>로 변환됩니다.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 서명 알고리듬 정보를 담은 객체, 혹은 객체들의 집합 어레이. 각 객체들은 다음의 정보를 갖습니다.
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 서명 알고리듬. 서명 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 키 데이터. <code>k</code>도 가능합니다.</li>
        <li><code>keyID</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 ID. <code>kid</code>도 가능합니다.</li>
        <li><code>privateKey</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 개인키</li>
        <li><code>protectContentOnly</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 컨텐츠만 보호받습니다.</li>
        <li><code>protectHeader</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 모든 헤더 값이 보호받습니다.</li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 옵션 객체
      <ul>
        <li><code>serialize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 다음의 하나의 값을 갖습니다: <code>general</code> | <code>flattened</code> | <code>compact</code>. 기본 값은 <code>compact</code>입니다.</li>
        <li><code>detachedPayload</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>일 경우 <code>payload</code> 데이터는 리턴되는 데이터에서 제외됩니다.</li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 서명을 한 후 <code>JWT</code> 데이터를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 혹은 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a>형태로 리턴합니다.</li>
  </ul>

  <pre class="prettyprint p-4">
// algorithm_params가 객체로 오는 경우

jCastle.jose.jws.sign(
  payload,
  { // algorithm_params_info
    type: 'JWT',
    algoName: 'RS256',
    keyID: '2010-12-29',
    key: rsaPrivateKey
  },
  { // options
    serialize: 'general'
  }
);

// algorithm_params가 집합으로 오는 경우
// 집합으로 오는 경우는 일반적으로 jwt 발송 대상자들이 여럿이 있을 경우이다.

jCastle.jose.jws.sign(
  payload,
  [
    {
      algoName:"RS256",
      keyID:"2010-12-29",
      key: rsa_private_key
    }, {
      algoName:"ES256",
      keyID:"e9bc097a-ce51-4036-9562-d2ade882db0d",
      key: ecdsa_private_key,

      // Protecting Content Only
      // if only content is protected. it means 'alg' is not protected.
      protectContentOnly: true
    },
    {
      algoName: "HS256",
      keyID: "018c0ae5-4d9b-471b-bfd6-eef314bc7037",

      // Protecting JWS Header
      // all header values need to be protected.
      protectHeader: true
    }
  ],
  { // options
    serialize: 'general',

    // if 'detachedPayload' is true, 
    // then the resulting JWS objects do not include the Payload content.
    detachedPayload: true,
  }
);
  </pre>

  <!-- jCastle.jose.jws.verify(jwt, algo_params, options) -->
  <h4>Static method: <code>jCastle.jose.jws.verify(jwt, algo_params, options)</code> <span><a class="mark" href="#static-jose-jws-verify" id="static-jose-jws-verify">#</a></span><a aria-hidden="true" class="legacy" id="static_jose_jws_verify"></a></h4>

  <p> 주어진 <code>JWS</code> 토큰을 검증합니다.</p>

  <ul>
    <li><code>jwt</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 검증할 <code>JWS</code> 토큰 데이터.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 서명 알고리듬 정보를 담은 객체.
      <ul>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 옵션 객체
      <ul>
        <li><code>payload</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 서명할 입력 데이터. 서명 시 <code>detachedPayload</code>값을 <code>true</code>로 설정했다면 <code>payload</code>데이터는 <code>JWT</code>에 포함되지 않습니다. </li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 검증을 한 결과를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 형태로 리턴합니다.</li>
  </ul>

  <!-- jCastle.jose.jws.validate(jwt, algo_params) -->

  <!-- jCastle.jose.jws.parse(jwt) -->

  <!-- jCastle.jose.jwe.encrypt(message, algo_params, enc_algo_params, options) -->
  <h4>Static method: <code>jCastle.jose.jwe.encrypt(message, algo_params, enc_algo_params, options)</code> <span><a class="mark" href="#static-jose-jwe-encrypt" id="static-jose-jwe-encrypt">#</a></span><a aria-hidden="true" class="legacy" id="static_jose_jwe_encrypt"></a></h4>

  <p> 암호화를 진행하여 <code>JWE</code> 토큰을 생성합니다.</p>

  <ul>
    <li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 암호화할 메시지 데이터.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 키 암호화 알고리듬 정보를 담은 객체 혹은 객체들의 집합. 각 객체들은 다음의 프로퍼티를 가질 수 있습니다:
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 암호화 알고리듬 명칭. 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
        <li><code>keyID</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 ID. <code>kid</code>도 가능합니다.</li>
        <li><code>password</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 비밀번호</li>
        <li><code>count</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&#x3C;Integer></a> <code>Count</code> 값.</li>
        <li><code>salt</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>Salt</code> 값.</li>
        <li><code>iv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>IV</code> 값.</li>
        <li><code>partyPublicKey</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 상대방 공개키</li>
        <li><code>apu</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>APU</code> 값.</li>
        <li><code>apv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>APV</code> 값.</li>
      </ul>
    </li>
    <li><code>enc_algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 메시지(컨텐트) 암호화 알고리듬 정보를 담은 객체.
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 메시지 암호화 알고리듬 명칭.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
        <li><code>iv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>IV</code> 값.</li>
        <li><code>aad</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>AdditionalData</code> 값</li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 암호화에 필요한 변수들을 담은 객체
      <ul>
        <li><code>serialize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 다음의 하나의 값을 갖습니다: <code>general</code> | <code>flattened</code> | <code>compact</code>. 기본 값은 <code>compact</code>입니다.</li>
        <li><code>protectHeader</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 모든 헤더 값이 보호받습니다.</li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 암호화한 <code>JWT</code> 데이터를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 혹은 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a>형태로 리턴합니다.</li>
  </ul>



  <pre class="prettyprint p-4">
// plaintext is encrypted by cek with enc_algo_params. enc_algo_params can have cek.
// cek (content encryption key) is encrypted by keywrap_algo_params.
jCastle.jose.encrypt(plaintext, keywrap_algo_params, enc_algo_params, options)
------------------------------------------------------------------------------
jCastle.jose.jwe.encrypt(
  plaintext,
  {
    algoName: 'RSA1_5',
    keyID: '2011-04-29',
    key: rsa_publicKey
  },
  {
    algoName: 'AES256GCM',
  },
  {
    serialize: 'general'
  }
);

jCastle.jose.jwe.encrypt(
  plaintext,
  [ // keywrap_algo_params. arrays of objects of keywrap or an object of keywrap.
    { // if key_encyption parameter is not an array then the serialization will be flattened.
      algoName: 'RSA1_5',
      keyID: '2011-04-29',
      key: rsa_public_key,
    },{
      algoName: 'PBES2-HS256+A128KW',
      keyID: '3045-2543-2884',
      password: password,
      salt: salt,
      count: 1000
    }, {
      algoName: 'A128GCMKW',
      keyID: '7',
      key: key,
      iv: initial_vector // 96 bits = 12 bytes
    }, {
      algoName: 'ECDH-ES+A128KW',
      partyPublicKey: party_public_key,
      key: issuer_temporal_key,
      apu: apu,
      apv: apv
    }, {
      algoName: 'DIR',
      cek: content_encrypt_key
    }
  ],
  { // encryption algorithm params
    algoName: 'AES256GCM',
    key: cek, // if it does not exist then it will be created.
    iv: iv,   // if it does not exist then it will be created.

    // custom authenticated additional data
    // aad should be base64url string
    aad: aad_b64u
  },
  {
    unprotected: {"jku":"https://server.example.com/keys.jwks"}, // this one is shared unprotected header
    serialize: 'general',

    // protecting JWE header
    // this option only works when keywrap_algo_params counter or length is 1.
    //
    // this is for NIST RFC 7520 cookbook example.
    // the general JWE in RFC 7520 has a different structure from RFC 7516.
    // when this option is true then JOSE header is protected.
    protectHeader: true
  }
);
  </pre>

  <!-- jCastle.jose.jwe.decrypt(jwt, keywrap_algo_params) -->
  <h4>Static method: <code>jCastle.jose.jwe.decrypt(jwt, keywrap_algo_params)</code> <span><a class="mark" href="#static-jose-jwe-decrypt" id="static-jose-jwe-decrypt">#</a></span><a aria-hidden="true" class="legacy" id="static_jose_jwe_decrypt"></a></h4>

  <p> 복호화를 진행합니다.</p>

  <ul>
    <li><code>jwt</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 복호화할 데이터.
    </li>
    <li><code>keywrap_algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 키 암호화 알고리듬 정보를 담은 객체:
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 암호화 알고리듬 명칭. 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요. <code>algoName</code>외 <code>algo</code>나 <code>alg</code>를 쓸 수 있습니다.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 복호화한 데이터를 <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a>로 리턴합니다.</li>
  </ul>

  <hr>

  <!-- jose.reset() -->
  <h4><code>jose.reset()</code> <span><a class="mark" href="#jose-reset" id="jose-reset">#</a></span><a aria-hidden="true" class="legacy" id="jose_reset"></a></h4>

  <p>입력되었던 모든 데이터들을 초기화 합니다.</p>

  <ul>
    <li>Return Value: 오브젝트 자신을 리턴합니다.</li>
  </ul>

  <!-- jose.sign(message, params, options = {}) -->
  <h4><code>jose.sign(payload, algo_params, options)</code> <span><a class="mark" href="#jose-sign" id="jose-sign">#</a></span><a aria-hidden="true" class="legacy" id="jose_sign"></a></h4>

  <p> 주어진 데이터를 가지고 <code>JWS</code> 서명을 생성합니다.</p>

  <ul>
    <li><code>payload</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 서명할 입력 데이터. 만일 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a>으로 주어지면 자동으로 <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a>로 변환됩니다.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 서명 알고리듬 정보를 담은 객체, 혹은 객체들의 집합 어레이. 각 객체들은 다음의 정보를 갖습니다.
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 서명 알고리듬. 서명 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 키 데이터. <code>k</code>도 가능합니다.</li>
        <li><code>keyID</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 ID. <code>kid</code>도 가능합니다.</li>
        <li><code>privateKey</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 개인키</li>
        <li><code>protectContentOnly</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 컨텐츠만 보호받습니다.</li>
        <li><code>protectHeader</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 모든 헤더 값이 보호받습니다.</li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 옵션 객체
      <ul>
        <li><code>serialize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 다음의 하나의 값을 갖습니다: <code>general</code> | <code>flattened</code> | <code>compact</code>. 기본 값은 <code>compact</code>입니다.</li>
        <li><code>detachedPayload</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>일 경우 <code>payload</code> 데이터는 리턴되는 데이터에서 제외됩니다.</li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 서명을 한 후 <code>JWT</code> 데이터를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 혹은 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a>형태로 리턴합니다.</li>
  </ul>

  <!-- jose.verify(jwt, params, options = {}) -->
  <h4><code>jose.verify(jwt, algo_params, options)</code> <span><a class="mark" href="#jose-verify" id="jose-verify">#</a></span><a aria-hidden="true" class="legacy" id="jose_verify"></a></h4>

  <p> 주어진 <code>JWS</code> 토큰을 검증합니다.</p>

  <ul>
    <li><code>jwt</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 검증할 <code>JWS</code> 토큰 데이터.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 서명 알고리듬 정보를 담은 객체.
      <ul>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 옵션 객체
      <ul>
        <li><code>payload</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 서명할 입력 데이터. 서명 시 <code>detachedPayload</code>값을 <code>true</code>로 설정했다면 <code>payload</code>데이터는 <code>JWT</code>에 포함되지 않습니다. </li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 검증을 한 결과를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 형태로 리턴합니다.</li>
  </ul>

  <!-- jose.validate(jwt, algo_params) -->

  <!-- jose.parse(jwt) -->

  <!-- jose.encrypt(message, algo_params, enc_algo_params, options = {}) -->
  <h4><code>jose.encrypt(message, algo_params, enc_algo_params, options)</code> <span><a class="mark" href="#jose-encrypt" id="jose-encrypt">#</a></span><a aria-hidden="true" class="legacy" id="jose_encrypt"></a></h4>

  <p> 암호화를 진행하여 <code>JWE</code> 토큰을 생성합니다.</p>

  <ul>
    <li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 암호화할 메시지 데이터.
    </li>
    <li><code>algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 키 암호화 알고리듬 정보를 담은 객체 혹은 객체들의 집합. 각 객체들은 다음의 프로퍼티를 가질 수 있습니다:
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 암호화 알고리듬 명칭. 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
        <li><code>keyID</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 ID. <code>kid</code>도 가능합니다.</li>
        <li><code>password</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> 비밀번호</li>
        <li><code>count</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&#x3C;Integer></a> <code>Count</code> 값.</li>
        <li><code>salt</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>Salt</code> 값.</li>
        <li><code>iv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>IV</code> 값.</li>
        <li><code>partyPublicKey</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 상대방 공개키</li>
        <li><code>apu</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>APU</code> 값.</li>
        <li><code>apv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>APV</code> 값.</li>
      </ul>
    </li>
    <li><code>enc_algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 메시지(컨텐트) 암호화 알고리듬 정보를 담은 객체.
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 메시지 암호화 알고리듬 명칭.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
        <li><code>iv</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>IV</code> 값.</li>
        <li><code>aad</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> <code>AdditionalData</code> 값</li>
      </ul>
    </li>
    <li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 암호화에 필요한 변수들을 담은 객체
      <ul>
        <li><code>serialize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 다음의 하나의 값을 갖습니다: <code>general</code> | <code>flattened</code> | <code>compact</code>. 기본 값은 <code>compact</code>입니다.</li>
        <li><code>protectHeader</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#boolean_type" class="type">&#x3C;Boolean></a> 값이 <code>true</code>이면 모든 헤더 값이 보호받습니다.</li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 암호화한 <code>JWT</code> 데이터를 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 혹은 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a>형태로 리턴합니다.</li>
  </ul>

  <!-- jose.decrypt(jwt, keywrap_algo_params, options = {}) -->
  <h4><code>jose.decrypt(jwt, keywrap_algo_params)</code> <span><a class="mark" href="#jose-decrypt" id="jose-decrypt">#</a></span><a aria-hidden="true" class="legacy" id="jose_decrypt"></a></h4>

  <p> 복호화를 진행합니다.</p>

  <ul>
    <li><code>jwt</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> 복호화할 데이터.
    </li>
    <li><code>keywrap_algo_params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" class="type">&#x3C;Array></a> 키 암호화 알고리듬 정보를 담은 객체:
      <ul>
        <li><code>algoName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 암호화 알고리듬 명칭. 알고리듬 종류는 <a href="https://datatracker.ietf.org/doc/html/rfc7518">JSON Web Algorithms (JWA)</a>을 참조하세요. <code>algoName</code>외 <code>algo</code>나 <code>alg</code>를 쓸 수 있습니다.</li>
        <li><code>key</code> <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&#x3C;Object></a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&#x3C;string></a> 키 데이터. </li>
      </ul>
    </li>
  </ul> 

  <ul>
    <li>Return Value: 복호화한 데이터를 <a href="https://nodejs.org/dist/latest-v18.x/docs/api/buffer.html#class-buffer" class="type">&#x3C;Buffer></a>로 리턴합니다.</li>
  </ul>

  <hr>

  <p><code>JWS</code> example:</p>

  <pre class="prettyprint p-4">
var rsa_pub_jwk = {
  kty: "RSA",
  kid: "bilbo.baggins@hobbiton.example",
  use: "sig",
  n: `n4EPtAOCc9AlkeQHPzHStgAbgs7bTZLwUBZdR8_KuKPEHLd4rHVTeT
    -O-XV2jRojdNhxJWTDvNd7nqQ0VEiZQHz_AJmSCpMaJMRBSFKrKb2wqV
    wGU_NsYOYL-QtiWN2lbzcEe6XC0dApr5ydQLrHqkHHig3RBordaZ6Aj-
    oBHqFEHYpPe7Tpe-OfVfHd1E6cS6M1FZcD1NNLYD5lFHpPI9bTwJlsde
    3uhGqC0ZCuEHg8lhzwOHrtIQbS0FVbb9k3-tVTU4fg_3L_vniUFAKwuC
    LqKnS2BYwdq_mzSnbLY7h_qixoR7jig3__kRhuaxwUkRz5iaiQkqgc5g
    HdrNP5zw`,
  e: "AQAB",
};
var rsa_priv_jwk = {
  kty: "RSA",
  kid: "bilbo.baggins@hobbiton.example",
  use: "sig",
  n: `n4EPtAOCc9AlkeQHPzHStgAbgs7bTZLwUBZdR8_KuKPEHLd4rHVTeT
    -O-XV2jRojdNhxJWTDvNd7nqQ0VEiZQHz_AJmSCpMaJMRBSFKrKb2wqV
    wGU_NsYOYL-QtiWN2lbzcEe6XC0dApr5ydQLrHqkHHig3RBordaZ6Aj-
    oBHqFEHYpPe7Tpe-OfVfHd1E6cS6M1FZcD1NNLYD5lFHpPI9bTwJlsde
    3uhGqC0ZCuEHg8lhzwOHrtIQbS0FVbb9k3-tVTU4fg_3L_vniUFAKwuC
    LqKnS2BYwdq_mzSnbLY7h_qixoR7jig3__kRhuaxwUkRz5iaiQkqgc5g
    HdrNP5zw`,
  e: "AQAB",
  d: `bWUC9B-EFRIo8kpGfh0ZuyGPvMNKvYWNtB_ikiH9k20eT-O1q_I78e
    iZkpXxXQ0UTEs2LsNRS-8uJbvQ-A1irkwMSMkK1J3XTGgdrhCku9gRld
    Y7sNA_AKZGh-Q661_42rINLRCe8W-nZ34ui_qOfkLnK9QWDDqpaIsA-b
    MwWWSDFu2MUBYwkHTMEzLYGqOe04noqeq1hExBTHBOBdkMXiuFhUq1BU
    6l-DqEiWxqg82sXt2h-LMnT3046AOYJoRioz75tSUQfGCshWTBnP5uDj
    d18kKhyv07lhfSJdrPdM5Plyl21hsFf4L_mHCuoFau7gdsPfHPxxjVOc
    OpBrQzwQ`,
  p: `3Slxg_DwTXJcb6095RoXygQCAZ5RnAvZlno1yhHtnUex_fp7AZ_9nR
    aO7HX_-SFfGQeutao2TDjDAWU4Vupk8rw9JR0AzZ0N2fvuIAmr_WCsmG
    peNqQnev1T7IyEsnh8UMt-n5CafhkikzhEsrmndH6LxOrvRJlsPp6Zv8
    bUq0k`,
  q: `uKE2dh-cTf6ERF4k4e_jy78GfPYUIaUyoSSJuBzp3Cubk3OCqs6grT
    8bR_cu0Dm1MZwWmtdqDyI95HrUeq3MP15vMMON8lHTeZu2lmKvwqW7an
    V5UzhM1iZ7z4yMkuUwFWoBvyY898EXvRD-hdqRxHlSqAZ192zB3pVFJ0
    s7pFc`,
  dp: `B8PVvXkvJrj2L-GYQ7v3y9r6Kw5g9SahXBwsWUzp19TVlgI-YV85q
    1NIb1rxQtD-IsXXR3-TanevuRPRt5OBOdiMGQp8pbt26gljYfKU_E9xn
    -RULHz0-ed9E9gXLKD4VGngpz-PfQ_q29pk5xWHoJp009Qf1HvChixRX
    59ehik`,
  dq: `CLDmDGduhylc9o7r84rEUVn7pzQ6PF83Y-iBZx5NT-TpnOZKF1pEr
    AMVeKzFEl41DlHHqqBLSM0W1sOFbwTxYWZDm6sI6og5iTbwQGIC3gnJK
    bi_7k_vJgGHwHxgPaX2PnvP-zyEkDERuf-ry4c_Z11Cq9AqC2yeL6kdK
    T1cYF8`,
  qi: `3PiqvXQN0zwMeE-sBvZgi289XP9XCQF3VWqPzMKnIgQp7_Tugo6-N
    ZBKCQsMf3HaEGBjTVJs_jcK8-TRXvaKe-7ZMaQj8VfBdYkssbu0NKDDh
    jJ-GtiseaDVWt7dcH0cfwxgFUHpQh7FoCrjFJ6h6ZEpMF6xmujs4qMpP
    z8aaI4`,
};

var payload_b64u = `
SXTigJlzIGEgZGFuZ2Vyb3VzIGJ1c2luZXNzLCBGcm9kbywgZ29pbmcgb3V0IH
lvdXIgZG9vci4gWW91IHN0ZXAgb250byB0aGUgcm9hZCwgYW5kIGlmIHlvdSBk
b24ndCBrZWVwIHlvdXIgZmVldCwgdGhlcmXigJlzIG5vIGtub3dpbmcgd2hlcm
UgeW91IG1pZ2h0IGJlIHN3ZXB0IG9mZiB0by4`.replace(/[ \t\r\n]/g, "");
var payload = Buffer.from(payload_b64u, "base64url");

// compact mode
var compact_jwt = jCastle.jose.jws.sign(
  payload,
  {
    algoName: "RS256",
    key: rsa_priv_jwk,
    protectHeader: true,
  },
  {
    serialize: "compact",
  }
);
console.log("compact jwt: ");
console.log(compact_jwt);

var v = jCastle.jose.jws.verify(compact_jwt, {
  key: rsa_pub_jwk,
});
console.log(v);

// geneneral mode
var jwt = jCastle.jose.jws.sign(
  payload,
  {
    algoName: "RS256",
    key: rsa_priv_jwk,
    protectHeader: true,
  },
  {
    serialize: "general",
  }
);
console.log(jwt);

var v = jCastle.jose.jws.verify(jwt, {
  key: rsa_pub_jwk,
});
  </pre>

  <p><code>JWE</code> example:</p>

  <pre class="prettyprint p-4">
var plaintext = `You can trust us to stick with you through thick and
thin–to the bitter end. And you can trust us to
keep any secret of yours–closer than you keep it
yourself. But you cannot trust us to let you face trouble
alone, and go off without a word. We are your friends, Frodo.`.replace(
  /\n/g,
  " "
);
var rsa_priv_jwk = {
  kty: "RSA",
  kid: "frodo.baggins@hobbiton.example",
  use: "enc",
  n: `maxhbsmBtdQ3CNrKvprUE6n9lYcregDMLYNeTAWcLj8NnPU9XIYegT
    HVHQjxKDSHP2l-F5jS7sppG1wgdAqZyhnWvXhYNvcM7RfgKxqNx_xAHx
    6f3yy7s-M9PSNCwPC2lh6UAkR4I00EhV9lrypM9Pi4lBUop9t5fS9W5U
    NwaAllhrd-osQGPjIeI1deHTwx-ZTHu3C60Pu_LJIl6hKn9wbwaUmA4c
    R5Bd2pgbaY7ASgsjCUbtYJaNIHSoHXprUdJZKUMAzV0WOKPfA6OPI4oy
    pBadjvMZ4ZAj3BnXaSYsEZhaueTXvZB4eZOAjIyh2e_VOIKVMsnDrJYA
    VotGlvMQ`,
  e: "AQAB",
  d: `Kn9tgoHfiTVi8uPu5b9TnwyHwG5dK6RE0uFdlpCGnJN7ZEi963R7wy
    bQ1PLAHmpIbNTztfrheoAniRV1NCIqXaW_qS461xiDTp4ntEPnqcKsyO
    5jMAji7-CL8vhpYYowNFvIesgMoVaPRYMYT9TW63hNM0aWs7USZ_hLg6
    Oe1mY0vHTI3FucjSM86Nff4oIENt43r2fspgEPGRrdE6fpLc9Oaq-qeP
    1GFULimrRdndm-P8q8kvN3KHlNAtEgrQAgTTgz80S-3VD0FgWfgnb1PN
    miuPUxO8OpI9KDIfu_acc6fg14nsNaJqXe6RESvhGPH2afjHqSy_Fd2v
    pzj85bQQ`,
  p: `2DwQmZ43FoTnQ8IkUj3BmKRf5Eh2mizZA5xEJ2MinUE3sdTYKSLtaE
    oekX9vbBZuWxHdVhM6UnKCJ_2iNk8Z0ayLYHL0_G21aXf9-unynEpUsH
    7HHTklLpYAzOOx1ZgVljoxAdWNn3hiEFrjZLZGS7lOH-a3QQlDDQoJOJ
    2VFmU`,
  q: `te8LY4-W7IyaqH1ExujjMqkTAlTeRbv0VLQnfLY2xINnrWdwiQ93_V
    F099aP1ESeLja2nw-6iKIe-qT7mtCPozKfVtUYfz5HrJ_XY2kfexJINb
    9lhZHMv5p1skZpeIS-GPHCC6gRlKo1q-idn_qxyusfWv7WAxlSVfQfk8
    d6Et0`,
  dp: `UfYKcL_or492vVc0PzwLSplbg4L3-Z5wL48mwiswbpzOyIgd2xHTH
    QmjJpFAIZ8q-zf9RmgJXkDrFs9rkdxPtAsL1WYdeCT5c125Fkdg317JV
    RDo1inX7x2Kdh8ERCreW8_4zXItuTl_KiXZNU5lvMQjWbIw2eTx1lpsf
    lo0rYU`,
  dq: `iEgcO-QfpepdH8FWd7mUFyrXdnOkXJBCogChY6YKuIHGc_p8Le9Mb
    pFKESzEaLlN1Ehf3B6oGBl5Iz_ayUlZj2IoQZ82znoUrpa9fVYNot87A
    CfzIG7q9Mv7RiPAderZi03tkVXAdaBau_9vs5rS-7HMtxkVrxSUvJY14
    TkXlHE`,
  qi: `kC-lzZOqoFaZCr5l0tOVtREKoVqaAYhQiqIRGL-MzS4sCmRkxm5vZ
    lXYx6RtE1n_AagjqajlkjieGlxTTThHD8Iga6foGBMaAr5uR1hGQpSc7
    Gl7CF1DZkBJMTQN6EshYzZfxW08mIO8M6Rzuh0beL6fG9mkDcIyPrBXx
    2bQ_mM`,
};
var cek_b64u = "3qyTVhIWt5juqZUCpfRqpvauwB956MEJL2Rt-8qXKSo";
var iv_b64u = "bbd5sTkYwhAIqfHsx8DayA";

// compact mode
var compact_jwe = jCastle.jose.jwe.encrypt(
  plaintext,
  {
    algoName: "RSA1_5",
    key: rsa_priv_jwk,
  },
  {
    algoName: "A128CBC-HS256",
    key: Buffer.from(cek_b64u, "base64url"),
    iv: Buffer.from(iv_b64u, "base64url"),
  },
  {
    serialize: "compact",
  }
);
console.log(compact_jwe);

var v = jCastle.jose.jwe.decrypt(compact_jwe, {
  algoName: "RSA1_5",
  key: rsa_priv_jwk,
});
console.log(v.toString() == plaintext);

var jwe = `
eyJhbGciOiJSU0ExXzUiLCJraWQiOiJmcm9kby5iYWdnaW5zQGhvYmJpdG9uLm
V4YW1wbGUiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0
.
laLxI0j-nLH-_BgLOXMozKxmy9gffy2gTdvqzfTihJBuuzxg0V7yk1WClnQePF
vG2K-pvSlWc9BRIazDrn50RcRai__3TDON395H3c62tIouJJ4XaRvYHFjZTZ2G
Xfz8YAImcc91Tfk0WXC2F5Xbb71ClQ1DDH151tlpH77f2ff7xiSxh9oSewYrcG
TSLUeeCt36r1Kt3OSj7EyBQXoZlN7IxbyhMAfgIe7Mv1rOTOI5I8NQqeXXW8Vl
zNmoxaGMny3YnGir5Wf6Qt2nBq4qDaPdnaAuuGUGEecelIO1wx1BpyIfgvfjOh
MBs9M8XL223Fg47xlGsMXdfuY-4jaqVw
.
bbd5sTkYwhAIqfHsx8DayA
.
0fys_TY_na7f8dwSfXLiYdHaA2DxUjD67ieF7fcVbIR62JhJvGZ4_FNVSiGc_r
aa0HnLQ6s1P2sv3Xzl1p1l_o5wR_RsSzrS8Z-wnI3Jvo0mkpEEnlDmZvDu_k8O
WzJv7eZVEqiWKdyVzFhPpiyQU28GLOpRc2VbVbK4dQKPdNTjPPEmRqcaGeTWZV
yeSUvf5k59yJZxRuSvWFf6KrNtmRdZ8R4mDOjHSrM_s8uwIFcqt4r5GX8TKaI0
zT5CbL5Qlw3sRc7u_hg0yKVOiRytEAEs3vZkcfLkP6nbXdC_PkMdNS-ohP78T2
O6_7uInMGhFeX4ctHG7VelHGiT93JfWDEQi5_V9UN1rhXNrYu-0fVMkZAKX3VW
i7lzA6BP430m
.
kvKuFBXHe5mQr4lqgobAUg`.replace(/[ \t\r\n]/g, "");
var v = jCastle.jose.jwe.decrypt(jwe, {
  algoName: "RSA1_5",
  key: rsa_priv_jwk,
});
console.log(v.toString() == plaintext);

// general mode
var general_jwe = jCastle.jose.jwe.encrypt(
  plaintext,
  {
    algoName: "RSA1_5",
    key: rsa_priv_jwk,
  },
  {
    algoName: "A128CBC-HS256",
    key: Buffer.from(cek_b64u, "base64url"),
    iv: Buffer.from(iv_b64u, "base64url"),
  },
  {
    serialize: "general",
    protectHeader: true,
  }
);
console.log(general_jwe);
  </pre>



</section>  

        <!-- API END -->
        </div>
      </div>
    </div>

<script src="../static/lib/code-prettify/loader/run_prettify.js"></script>
<!-- this stylesheet's position is important! -->
<link rel="stylesheet" href="../static/lib/code-prettify/loader/skins/tranquil-heart.min.css">
</body>
</html>    